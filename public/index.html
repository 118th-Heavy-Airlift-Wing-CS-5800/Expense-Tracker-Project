<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expense Tracker (CS 5800)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Simple Expense Tracker</h1>
  
  <form id="expenseForm">
    <label>Category: <input type="text" id="category" required></label>
    <label>Amount: <input type="number" id="amount" required></label>
    <button type="submit">Add Expense</button>
  </form>

  <h2>Set Budget</h2>
    <input type="number" id="budgetAmount" placeholder="Enter your budget">
    <button onclick="setBudget()">Set Budget</button>

    <h3 id="budgetDisplay">Budget: $0.00</h3>
    <h3 id="balanceDisplay">Remaining Balance: $0.00</h3>


  <button id="clearExpensesBtn">Clear All Expenses</button>

  <hr>

  <h2>Add Expense</h2>
  <input type="text" id="expenseCategory" placeholder="Category">
  <input type="number" id="expenseAmount" placeholder="Amount">
  <button onclick="addExpense()">Add Expense</button>

  <h3>Expenses</h3>
  <ul id="expenseList"></ul>
  <canvas id="expenseChart" width="400" height="400"></canvas>

  <h3 id="totalExpenses">Total Expenses: $0.00</h3>

  <script>
  let total = 0;
  let budget = 0;
  let expenseData = {}; // Tracks category totals
  let chart; // Chart.js instance

  function addExpense() {
    const categoryInput = document.getElementById("expenseCategory");
    const amountInput = document.getElementById("expenseAmount");

    const category = categoryInput.value.trim();
    const amount = parseFloat(amountInput.value);

    if (category === "" || isNaN(amount)) {
      alert("Please enter a valid category and amount.");
      return;
    }

    const li = document.createElement("li");
    li.textContent = `Category: ${category}, Amount: $${amount.toFixed(2)} `;

    const deleteBtn = document.createElement("button");
    deleteBtn.textContent = "Delete";
    deleteBtn.style.marginLeft = "10px";
    deleteBtn.onclick = function () {
      li.remove();
      total -= amount;
      expenseData[category] -= amount;
      if (expenseData[category] <= 0) delete expenseData[category];
      updateTotal();
      updateBalance();
      updateChart();
    };

    li.appendChild(deleteBtn);
    document.getElementById("expenseList").appendChild(li);

    total += amount;
    expenseData[category] = (expenseData[category] || 0) + amount;

    updateTotal();
    updateBalance();
    updateChart();

    categoryInput.value = "";
    amountInput.value = "";
  }

  function updateTotal() {
    const totalDisplay = document.getElementById("totalExpenses");
    totalDisplay.textContent = `Total Expenses: $${total.toFixed(2)}`;
    totalDisplay.style.color = total > budget ? "red" : "black";
    if (total > budget) {
      totalDisplay.textContent += " âš  Over Budget!";
    }
  }

  function setBudget() {
    const budgetInput = document.getElementById("budgetAmount");
    const value = parseFloat(budgetInput.value);

    if (isNaN(value) || value < 0) {
      alert("Please enter a valid budget amount.");
      return;
    }

    budget = value;
    document.getElementById("budgetDisplay").textContent = `Budget: $${budget.toFixed(2)}`;
    updateBalance();
    budgetInput.value = "";
  }

  function updateBalance() {
    const balance = budget - total;
    document.getElementById("balanceDisplay").textContent = `Remaining Balance: $${balance.toFixed(2)}`;
  }

  function updateChart() {
    const ctx = document.getElementById("expenseChart").getContext("2d");

    const categories = Object.keys(expenseData);
    const amounts = Object.values(expenseData);

    if (chart) chart.destroy(); // Destroy old chart before creating new one

    chart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: categories,
        datasets: [{
          label: 'Expenses by Category',
          data: amounts,
          backgroundColor: [
            '#FF6384', '#36A2EB', '#FFCE56',
            '#4BC0C0', '#9966FF', '#FF9F40'
          ],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' }
        }
      }
    });
  }
</script>



  
  <h2>Set Budget</h2>
    <input type="text" id="budgetUsername" placeholder="Username">
    <input type="text" id="budgetName" placeholder="Budget Name">
    <input type="number" id="budgetAmount" placeholder="Budget Amount">
    <button id="setBudgetBtn">Set Budget</button>

  <hr>
  <h2>Check Balance</h2>
    <input type="text" id="balanceUsername" placeholder="Enter Username" />
    <button id="checkBalanceBtn">Check Balance</button>
    <p id="balanceOutput"></p>



  <h2>Create User</h2>
  <form id="userForm">
    <label>Username: <input type="text" id="usernameInput" required></label><br>
    <label>Email: <input type="email" id="emailInput" required></label><br>
    <label>Password: <input type="password" id="passwordInput" required></label><br>
    <button type="submit">Create User</button>
  </form>


  <div id="userOutput"></div>
  <hr>

  <h2>All Expenses</h2>

  <script src="script.js"></script>
</body>

</html>